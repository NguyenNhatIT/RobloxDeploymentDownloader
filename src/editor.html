<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Roblox LuaU Editor</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Tilt+Neon&display=swap');

    :root {
      --bg-color: #0E0A17;
      --text-color: #bcb9c4;
      --accent-color: #586BA8;
      --hover-color: #151320;
      --border-color: #151324;
      --secondary-text: #7e7d81;
      --function-color: #dcdcaa;
      --property-color: #56B6C2;
    }

    html, body {
      width: 100%;
      height: 100%;
      margin: 0;
      background: var(--bg-color);
      color: var(--text-color);
      overflow: hidden;
      font-family: 'Tilt Neon', monospace;
    }

    #container {
      width: 100%;
      height: 100vh;
    }
  </style>
</head>
<body>
  <div id="container"></div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.33.0/min/vs/loader.min.js"></script>
  <script>
    require.config({ paths: { 'vs': 'https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.33.0/min/vs' } });

    require(['vs/editor/editor.main'], function () {
      // 🧩 Language setup
      monaco.languages.register({ id: 'luau' });

      monaco.languages.setMonarchTokensProvider('luau', {
        tokenizer: {
          root: [
            [/\b(function|local|end|if|then|elseif|else|for|in|while|repeat|until|return|break|and|or|not|nil|true|false)\b/, 'keyword'],
            [/[a-zA-Z_]\w*(?=\s*\()/, 'function'],
            [/[a-zA-Z_]\w*(?=\.)/, 'variable'],
            [/\.[a-zA-Z_]\w*/, 'property'],
            [/\d+(\.\d+)?/, 'number'],
            [/".*?"/, 'string'],
            [/'.*?'/, 'string'],
            [/--.*/, 'comment'],
          ],
        }
      });

      // 🎨 Custom theme
      monaco.editor.defineTheme('RobloxLuauTheme', {
        base: 'vs-dark',
        inherit: true,
        rules: [
          { token: '', foreground: 'bcb9c4' },
          { token: 'keyword', foreground: '586BA8', fontStyle: 'bold' },
          { token: 'string', foreground: 'A8B4FF' },
          { token: 'number', foreground: 'B5CEA8' },
          { token: 'function', foreground: 'dcdcaa' },
          { token: 'property', foreground: '56B6C2' },
          { token: 'comment', foreground: '5C6370', fontStyle: 'italic' },
        ],
        colors: {
          'editor.background': '#0E0A17',
          'editor.foreground': '#bcb9c4',
          'editorCursor.foreground': '#586BA8',
          'editorLineNumber.foreground': '#7e7d81',
          'editorLineNumber.activeForeground': '#586BA8',
          'editor.selectionBackground': '#2a365c',
          'scrollbarSlider.activeBackground': '#2d355c',
        }
      });

      // 🧠 Roblox API completion
      const robloxAPI = [
        { label: 'game', kind: monaco.languages.CompletionItemKind.Variable, documentation: 'The root DataModel object.' },
        { label: 'workspace', kind: monaco.languages.CompletionItemKind.Variable, documentation: 'Contains all 3D objects in the game.' },
        { label: 'Instance', kind: monaco.languages.CompletionItemKind.Class, documentation: 'Base class for all Roblox objects.' },
        { label: 'Enum', kind: monaco.languages.CompletionItemKind.Module, documentation: 'Holds all enums available in Roblox.' },
        { label: 'task', kind: monaco.languages.CompletionItemKind.Module, documentation: 'Roblox task library for scheduling asynchronous work.' },
        { label: 'task.wait', kind: monaco.languages.CompletionItemKind.Function, documentation: 'Yields the current thread for the specified amount of time.' },
        { label: 'wait', kind: monaco.languages.CompletionItemKind.Function, documentation: 'Yields the current thread briefly.' },
        { label: 'print', kind: monaco.languages.CompletionItemKind.Function, documentation: 'Prints output to console.' },
        { label: 'warn', kind: monaco.languages.CompletionItemKind.Function, documentation: 'Prints warning to console.' },
        { label: 'require', kind: monaco.languages.CompletionItemKind.Function, documentation: 'Loads and returns a module script.' },
        { label: 'Vector3', kind: monaco.languages.CompletionItemKind.Class, documentation: 'Represents a 3D vector.' },
        { label: 'CFrame', kind: monaco.languages.CompletionItemKind.Class, documentation: 'Represents the position and rotation in 3D space.' },
        { label: 'Color3', kind: monaco.languages.CompletionItemKind.Class, documentation: 'Represents RGB color values.' },
      ];

      // 🔸 Gợi ý thuộc tính Roblox (nhiều hiệu ứng hơn)
      const robloxProperties = [
        { label: 'Parent', kind: monaco.languages.CompletionItemKind.Property, documentation: 'Parent of the Instance.' },
        { label: 'Name', kind: monaco.languages.CompletionItemKind.Property, documentation: 'The name of the Instance.' },
        { label: 'BrickColor', kind: monaco.languages.CompletionItemKind.Property, documentation: 'BrickColor of a Part.' },
        { label: 'Position', kind: monaco.languages.CompletionItemKind.Property, documentation: 'Position of the object in 3D space.' },
        { label: 'Anchored', kind: monaco.languages.CompletionItemKind.Property, documentation: 'Determines if the part is anchored.' },
        { label: 'Transparency', kind: monaco.languages.CompletionItemKind.Property, documentation: 'Transparency of the object.' },
        { label: 'Material', kind: monaco.languages.CompletionItemKind.Property, documentation: 'Material of a Part.' },
      ];

      monaco.languages.registerCompletionItemProvider('luau', {
        triggerCharacters: ['.', ':'],
        provideCompletionItems: (model, position) => {
          const textUntilPosition = model.getValueInRange({
            startLineNumber: position.lineNumber,
            startColumn: 1,
            endLineNumber: position.lineNumber,
            endColumn: position.column
          });

          if (textUntilPosition.endsWith('.')) {
            // Suggest properties
            const suggestions = robloxProperties.map(prop => ({
              label: prop.label,
              kind: prop.kind,
              insertText: prop.label,
              documentation: prop.documentation
            }));
            return { suggestions };
          } else {
            // Suggest base API
            const suggestions = robloxAPI.map(api => ({
              label: api.label,
              kind: api.kind,
              insertText: api.label,
              documentation: api.documentation
            }));
            return { suggestions };
          }
        }
      });

      // 🧩 Create editor
      window.editor = monaco.editor.create(document.getElementById('container'), {
        value: `-- Made By Nguyễn Minh Nhật
print("Hello Roblox!")

local part = Instance.new("Part")
part.Parent = workspace
part.BrickColor = BrickColor.new("Bright blue")
part.Anchored = true
part.Position = Vector3.new(0, 10, 0)
`,
        language: 'luau',
        theme: 'RobloxLuauTheme',
        fontFamily: "'Tilt Neon', Consolas, monospace",
        fontSize: 15,
        cursorBlinking: 'smooth',
        smoothScrolling: true,
        minimap: { enabled: true },
        automaticLayout: true,
      });
    });
  </script>
</body>
</html>
